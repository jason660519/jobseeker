# Railway deployment configuration for JobSpy Flask application
# Optimized for Railway's Nixpacks Python environment

[variables]
# Environment variables
FLASK_ENV = "production"
FLASK_DEBUG = "false"
PYTHON_VERSION = "3.10"

[phases.setup]
# Install system dependencies and ensure Python/pip are available
cmds = [
    "apt-get update",
    "apt-get install -y build-essential curl git python3 python3-pip python3-venv",
    "python3 --version",
    "python3 -m pip --version"
]

[phases.install]
# Install Python dependencies using python3 -m pip for reliability
cmds = [
    "python3 -m pip install --upgrade pip setuptools wheel",
    "python3 -m pip install -e .",
    "python3 -m pip install -r web_app/requirements.txt"
]

[phases.build]
# Build phase
cmds = [
    "echo 'JobSpy build completed successfully'"
]

[start]
# Start command for production
cmd = "cd web_app && python3 -m gunicorn app:app --bind 0.0.0.0:$PORT --workers 2 --timeout 120 --access-logfile - --error-logfile -"
